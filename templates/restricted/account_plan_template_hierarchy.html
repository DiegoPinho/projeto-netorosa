{% extends "restricted/base.html" %}

{% block title %}PMOrganizer | {{ page_title }}{% endblock %}

{% block content %}
  <section class="section">
    <div class="section-title">
      <span class="eyebrow">Plano de contas</span>
      <h2>{{ page_title }}</h2>
      <p>Explore contas por niveis em cada modelo.</p>
    </div>

    <div class="list-card">
      <div class="list-header">
        <h3>Mapa hierarquico</h3>
        <div class="list-actions">
          <span class="muted">{{ templates|length }} modelos</span>
          <a class="btn btn-ghost btn-sm" href="{% url 'cadastros_web:account_plan_template_list' %}">Voltar</a>
        </div>
      </div>

      {% if templates %}
        <div class="hierarchy-grid">
          {% for template in templates %}
            <details class="hierarchy-node level-1" open>
              <summary class="hierarchy-row">
                <span class="hierarchy-label">Modelo</span>
                <span class="hierarchy-value">{{ template.name }}</span>
                <span class="hierarchy-meta">{{ template.item_count }} contas Â· {{ template.max_level }} niveis</span>
                <span class="hierarchy-toggle" aria-hidden="true"></span>
              </summary>
              <div class="hierarchy-children">
                {% if template.roots %}
                  {% for node in template.roots %}
                    {% include "restricted/account_plan_template_node.html" with node=node %}
                  {% endfor %}
                {% else %}
                  <div class="empty-state">Nenhuma conta cadastrada.</div>
                {% endif %}
              </div>
            </details>
          {% endfor %}
        </div>
      {% else %}
        <div class="empty-state">Nenhum modelo cadastrado.</div>
      {% endif %}
    </div>
  </section>
{% endblock %}
